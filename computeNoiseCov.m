function computeNoiseCov(SubjectName, NoiseCondName, NoiseTime)
% Compute Noise Covariance from condition=NoiseCondName in Brainstorm
% e.g. computeNoiseCov('Subject_001','Night1_noise',[0,84])

    bst_report('Start', []);
    sFiles = bst_process('CallProcess', 'process_select_files_data', [], [], ...
        'subjectname',   SubjectName, ...
        'condition',     NoiseCondName, ...
        'tag',           '', ...
        'includebad',    0, ...
        'includeintra',  0, ...
        'includecommon', 0, ...
        'outprocesstab', 'no');

    if isempty(sFiles)
        disp(['No data files found => condition=' NoiseCondName]);
        return;
    end

    bst_process('CallProcess', 'process_noisecov', sFiles, [], ...
        'baseline',       NoiseTime, ...
        'datatimewindow', NoiseTime, ...
        'sensortypes',    'EEG', ...
        'target',         1, ... % noise covariance
        'dcoffset',       1, ...
        'identity',       0, ...
        'copycond',       1, ...
        'copysubj',       1, ...
        'copymatch',      0, ...
        'replacefile',    1);
    bst_report('Save', []);
end
